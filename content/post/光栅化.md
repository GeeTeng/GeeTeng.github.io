---
title: "GAMES101_Work02" 

date: 2024-12-1 

draft: false

---

### 光栅化 rasterize

---

#### 屏幕坐标系

屏幕空间 - 在屏幕上建立一个坐标系

屏幕的左下角是原点（0，0） 向上是Y 向右是x

![Screen](/images/光栅化/Screen.png)



---

#### 视口变换

要做的事：[-1, 1]^3映射到屏幕上

其中：**width** 和 **height** 是屏幕或视口的宽度和高度

在标准化设备坐标中，3D物体的投影结果被限制在 (−1,−1)到 (1,1) 的范围：

- (−1,−1) 代表左下角
- (1,1) 代表右上角
- 这是一个对称的正方形坐标系，中心点是 (0,0)

我们需要将这个范围映射到屏幕坐标系：

- 左下角是 (0,0)，右上角是 (width,height)

$$
M_{viewport} = \begin{pmatrix}
\frac{width}{2} & 0 & 0 & \frac{width}{2}\\
0 & \frac{height}{2} & 0 & \frac{height}{2}\\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

---

#### 光栅显示设备

- **示波器**（曾经做过的物理实验）和早期显示器相同原理

​	阴极射线管 电子经过加速穿过显示设备 发生偏转 就可以看到CRT屏幕 （Cathode Ray Tube）

​	隔行扫描（第一帧记录奇数行 下一帧记录偶数行） 直到现在还在一些视频压缩中使用 缺点：画面撕裂

- **帧缓冲区**（FrameBuffer）

​	是内存中的一块区域，存储显示在屏幕上的像素数据并映射到屏幕上

- **液晶显示器**（LCD）

​	计算器、手机等，通过液晶扭曲，改变光的振动方向

- **发光二极管**（LED）

- **ElectroPhoretic**（电子墨水屏）

​	例如Kiddle，缺点：刷新率很低

---

> Question：为什么三角形被图形学广泛应用？

**Answer：**

- 三角形是最基础的多边形 可以拼凑成多边形
- 三个点一定是平面的 内部没有凹陷
- 三角形的几何计算效率高

---

#### 光栅化方法

**1.采样**：采样每个在三角形内部像素点的中心

```c++
for (int x = 0; x < xmax; x++)
    for (int y = 0; y < ymax; y++)
        image[x][y] = inside(tri, x + 0.5, y + 0.5);
```

inside函数判断像素点中心是否在三角形内部，如果在返回1，反之0

**2.判断点是否在三角形**

向量叉乘 如果三个叉乘结果都＞0 / < 0，则在三角形内

**3.光栅化计算加速（三角形遍历方法）**

由于三角形所涉及到的区域是能够确定的，所以没必要从整个视口大小的像素范围遍历

- **包围盒遍历**

  

  ![BoundingBox](/images/光栅化/BoundingBox.png)

  包围盒的大小如下
  $$
  [min(x_{p0}, x_{p1},x_{p2}), max(x_{p0}, x_{p1},x_{p2})] \times[min(y_{p0}, y_{p1},y_{p2}), max(y_{p0}, y_{p1},y_{p2})]
  $$
  
- **增量三角形遍历**



![ITT](/images/光栅化/ITT.png)

通过计算三角形边的直线方程 利用直线生成布雷森汉姆算法（Bresenham algorithm），可以确定三角形每一行的左边界和右边界

---

#### 抗锯齿 / 反走样

锯齿导致的原因：采样率不够高。
