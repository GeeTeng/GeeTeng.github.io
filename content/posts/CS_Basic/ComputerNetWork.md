---
title: "计算机网络"
date: 2025-01-13
tags: [CS Basic]
description: "计算机网络知识 胡科大教书匠笔记"
showDate: true
math: true
chordsheet: true
---

## 概述

### 计算机网络分类

![00](/images/CS_Basic/ComputerNetwork/00.png)

---

### 计算机网络体系结构

#### 七层OSI模型

应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

#### 五层模型

应用层、传输层、网络层、数据链路层、物理层

#### TCP/IP四层模型

应用层（HTTP\SMTP\DNS\RTP）、运输层(TCP\UDP)、网络层(IP)、网络接口层

![03](/images/CS_Basic/ComputerNetwork/03.png)

**协议三要素：**

- **语法**：定义交换信息的格式
- **语义**：定义收发双方要完成的操作
- **同步**：定义收发双方的时序关系

---

### 三种交换方式

#### 电路交换

电话交换机接通电话线的方式称为电路交换，使用电路交换传送计算机数据时，其线路的传输效率往往很低。

**三个步骤**：

- 建立连接
- 通话
- 释放连接



#### 分组交换

分组交换采用的是**存储转发**技术

在发送报文之前，先把较长的报文划分成一个个**更小的等长**的数据段；然后在数据段的前面加上一些由必要的控制信息组成的**首部**后，就构成了一个**分组**

**发送方**：构造分组、发送分组

**路由器**：缓存分组、转发分组

**接收方**：接受分组、还原报文

![01](/images/CS_Basic/ComputerNetwork/01.png)



#### 报文交换

用于早期的电报通信网，现在较少使用，通常被分组交换方式所取代。



#### 对比

![02](/images/CS_Basic/ComputerNetwork/02.png)

---

## 物理层

### 物理层的基本概念

解决再各种传输媒体上传输比特0和1的问题，给数据链路层提供透明传输比特流的服务，如：双绞线、同轴电缆、光纤等。

物理层协议的主要任务

- **机械特性**：指明接口所用接线器的**形状**和**尺寸**、引脚数目和排列、固定和锁定装置。
- **电气特性**：指明在接口电缆的各条线上出现的**电压的范围**。
- **功能特性**：指明某条线上出现的某一电平的**电压表示何种意义**。
- **过程特性**：指明对于不同功能的各种可能**事件的出现顺序**。

---

### 传输媒体

**导引型传输媒体**：同轴电缆、双绞线、光纤（多模光纤、单模光纤）、电力线

**非导引性传输媒体**：无线电波、微波、红外线、可见光

---

### 传输方式

#### 串行传输 / 并行传输

计算机远距离传输采用串行传输，计算机内部采用并行传输

#### 同步传输 / 异步传输

内同步（曼彻斯特编码）

异步是指字节之间异步

#### 单项通信（单工）/ 双向交替通信（半双工）/双向同时通信（全双工）

**单项通信**：**一种方向**，无线电广播就是这样的方式。

**双向交替通信**：**双方可以相互传输数据**，比如对讲机，但是不能同时传输。

**双向同时通信**：双方可以**同时发送、接收信息**，比如手机。

---

## 数据链路层

### 数据链路层概述

**链路**就是从一个结点到相邻结点的一段物理线路，而中间没有任何其他的交换结点。

**数据链路**是指把实现通信协议的硬件和软件加到链路上，就构成了链路。

数据链路层**以帧为单位传输和处理数据**

---

### 封装成帧

应用层传递应用层协议数据单元给运输层，运输层加上运输层协议首部传递给网络层，网络层将数据添加网络层协议首部传递给数据链路层，数据链路层添加**帧头**和**帧尾**。

![04](/images/CS_Basic/ComputerNetwork/04.png)

帧头和帧尾的作用之一就是**帧定界**。如下图，红色部分就是P2P帧定界标志。但是以太网MAC帧并没有帧定界标志。

> **那以太网的MAC帧怎么被提取一个个帧呢？**
>
> 实际上以太网V2的MAC帧交付给物理层后会添加前导码，前导码中前7个字节为**前同步码**，作用是使接收方的时针同步，之后的1字节为**帧开始定界符**。

![05](/images/CS_Basic/ComputerNetwork/05.png)

**透明传输**

透明传输是指不管所传数据是什么样的比特组合，都应当能够在链路上传送。**当所传数据中的比特组合恰巧与某一个控制信息完全一样时，就必须采取适当的措施，使接收方不会将这样的数据误认为是某种控制信息**。这样才能保证数据链路层的传输是透明的。



> **如何判断发送的数据中是帧定位符还是帧的数据？**
>
> 下图是P2P帧的格式，在数据部分每遇到5个1可以添加1个0，和帧的首尾区分开，在读取的时候再删除这个0。

![06](/images/CS_Basic/ComputerNetwork/06.png)



为了提高帧的传输效率，应当使帧的数据部分尽可能大一些。

---

### 差错检测

帧在传输过程中可能会出现误码，所以进行差错检测，在以太网V2的MAC帧中如上图，FCS就是检错码，通过检错算法就可以检查到是否出现了误码。

![07](/images/CS_Basic/ComputerNetwork/07.png)

#### 奇偶校验

如果有奇数个位发生误码，则奇偶性发生变化，可以检查出误码；

如果有偶数个位发生误码，则奇偶性不发生变化，无法检查出误码；

循环冗余校验CRC

- 收发双方约定好一个生成多项式G(x)；
- 发送方基于发送的数据和生成多项式计算出差错检测码（冗余码），将其添加到待传输数据的后面一起传输；
- 接收方通过生成多项式来计算收到的数据是否产生了误码

如：
$$
G(x) = x^4 + x^2 + x + 1
$$
![08](/images/CS_Basic/ComputerNetwork/08.png)

---

### 可靠传输

尽管误码不能完全避免，但如果能实现**发送方发送什么，接收方就能收到什么**，就成为可靠传输。

不可靠传输服务：仅仅丢弃有误码的帧，其他什么也不做。



**TCP**向其上层提供面向连接的可靠传输服务

**UDP**向其上层提供无连接、不可靠传输服务

**IP**向其上层提供无连接、不可靠传输服务

**802.11无线局域网**要求数据链路层实现可靠传输

**以太网**不要求数据链路层实现可靠传输

---

#### 停止-等待协议SW

如果接收方没有收到数据，发送方一直都收不到接收方传送回来的ACK，于是一直等待，所以要设置超时重传，选择略大于”从发送方到接收方的平均往返时间“，这样当超时的时候，发送方会重新传送数据。

![09](/images/CS_Basic/ComputerNetwork/09.png)

如果接收方发送的ACK丢失，发送方就不知道数据是否已经被接收，于是又发送一条DATA0数据给接收方，这时候接收方无法判断该数据是否接受过，所以要将分组带上序号，保证每次接收到的都是新的数据。

![10](/images/CS_Basic/ComputerNetwork/10.png)

但是接收方传送的ACK，发送方怎么判断是第几条信息的传送成功呢？当DATA0和DATA1同时发送时，如果都返回的是ACK，当有一条数据没有收到时，就无法判断出是哪条信息丢失了，所以要对ACK也编号。

但是数据链路层中一般不会出现ACK分组迟到的情况，因此在数据链路层中可以不用给ACK分组编号。

![11](/images/CS_Basic/ComputerNetwork/11.png)

停止-等待协议的信道利用率太低了，于是出现了其他两种协议，即**后退N帧协议GBN**和**选择重传协议SR**。

![12](/images/CS_Basic/ComputerNetwork/12.png)



#### 使用广播信道的数据链路层（共享式局域网）

**CSMA/CD（载波监听多点接入/碰撞检测）**

使用无线局域网

CSMA/CA（载波监听多点接入/碰撞避免）

