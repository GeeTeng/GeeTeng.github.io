<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

    <title>
    设计模式 | 
    
    GeeTeng</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="description" content="设计模式 更新中
    ">


<meta property="og:url" content="http://localhost:1313/posts/c&#43;&#43;/designpattern/">
  <meta property="og:site_name" content="GeeTeng">
  <meta property="og:title" content="设计模式">
  <meta property="og:description" content="设计模式 更新中">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-01-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-01-08T00:00:00+00:00">
    <meta property="article:tag" content="C&#43;&#43;">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="设计模式">
  <meta name="twitter:description" content="设计模式 更新中">


  <meta itemprop="name" content="设计模式">
  <meta itemprop="description" content="设计模式 更新中">
  <meta itemprop="datePublished" content="2025-01-08T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-01-08T00:00:00+00:00">
  <meta itemprop="wordCount" content="480">
  <meta itemprop="keywords" content="C&#43;&#43;">
<link rel="canonical" href="http://localhost:1313/posts/c&#43;&#43;/designpattern/" />

<link rel="icon" type="image/png" href="http://localhost:1313/image/favicon.ico">

<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/bulma.min.css">

<link rel="stylesheet" href="https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.css" />
<script defer src="https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdmirror.com/npm/katex@0.16.11/dist/contrib/auto-render.min.js" crossorigin="anonymous"
  onload="renderMathInElement(document.body, {
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false }
          ],
          throwOnError: false
        });"></script>



<link rel="stylesheet" href=/css/chordsheet.css>

<script src=/js/ramium.js></script>
<link rel="stylesheet" href=/css/ramium.css>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
    integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
    integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
    crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




</head>

<body>
    
     
    <style type="text/css">
        .fireworks {
            position: fixed;
            pointer-events: none;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
        }
        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;    
            height: 100vh;   
            z-index: -1;     
        }
    </style>
    <canvas class="fireworks"></canvas>
<script src="/js/anime.min.js"></script>
<script src="/js/fireworks.js"></script>


    <script type="text/javascript">
        fireworks.setCanvasSize();
    </script>
    <nav class="navbar is-dark" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href=/>
      
      <strong>GeeTeng </strong>
      
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
      data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      
      
      <a class="navbar-item" href="/">Home</a>
      
      
      
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">This Blog</a>
        <div class="navbar-dropdown">
          
          <a class="navbar-item" href="/tags/">All Tags</a>
          
          <a class="navbar-item" href="/posts/">All Posts</a>
          
        </div>
      </div>
      
      
      
      <a class="navbar-item" href="/about-me/">About Me</a>
      
      
    </div>

    <div class="navbar-end">
      

      
      <div class="navbar-item">
        <form id="cse-search-box-form-id" onsubmit="return executeQuery();" role="search">
          <div class="field has-addons">
            <div class="control is-expanded">
              <input id="cse-search-input-box-id" size=15 class="input" type="text" autocomplete="off"
                placeholder="&#xf1a0; Google search" style="font-family:Arial, FontAwesome">
            </div>

            <div class="control">
              <button type="submit" class="button is-black">
                <i class="fa fa-search"></i>
                </a>
              </button>
            </div>
          </div>
        </form>
      </div>
      
    </div>
  </div>
</nav><div class="columns is-centered">
        <div id="page-body" class="column is-7">

<div class="content-wrapper">
    
    
    <nav id="TableOfContents" class="table-of-contents">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#简单工厂模式">简单工厂模式</a></li>
        <li><a href="#策略模式strategy">策略模式（Strategy）</a></li>
        <li><a href="#单一职责原则">单一职责原则</a></li>
        <li><a href="#开放-封闭原则">开放-封闭原则</a></li>
        <li><a href="#依赖倒转原则">依赖倒转原则</a></li>
        <li><a href="#里氏替换原则">里氏替换原则</a></li>
        <li><a href="#装饰模式decorator-pattern">装饰模式（Decorator Pattern）</a></li>
        <li><a href="#享元模式flyweight">享元模式（FlyWeight）</a></li>
        <li><a href="#单例模式singleton">单例模式（Singleton）</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
    

    
    <div class="content blog">
        <h1>设计模式</h1>

        <div id="infobar" class="level is-mobile">
            <div class="level-left">
                
                <div class="level-item">
                    <p class="subtitle info date">Jan 8, 2025
                    </p>
                </div>
                

                <div class="level-item">
                    <p class="subtitle info">
                        11 mins read
                    </p>
                </div>
            </div>
            <div class="level-right is-hidden-touch">
                <div class="tags">
                    
                    <a class="tag is-dark is-rounded" href="/tags/c&#43;&#43;">C&#43;&#43;</a>
                    
                </div>
            </div>
        </div>

        <div class="tags is-hidden-desktop">
            
            <a class="tag is-dark is-rounded" href="/tags/c&#43;&#43;">C</a>
            
        </div>

        <div class="blog-text">
            

            <h2 id="简单工厂模式">简单工厂模式</h2>
<p><strong>Factory</strong>：工厂类是整个模式的关键.包含了必要的逻辑判断,根据外界给定的信息,决定究竟应该创建哪个具体类的对象。</p>
<p>客户端代码无需关心类的实现细节，如果需要新增运算，只需要新增对应的派生类，并在工厂中添加逻辑。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Operation</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> numberA;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> numberB;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> setNumberA(<span style="color:#66d9ef">double</span> a)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		numberA <span style="color:#f92672">=</span> a;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setNumberB</span>(<span style="color:#66d9ef">double</span> b)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		numberB <span style="color:#f92672">=</span> b;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> <span style="color:#a6e22e">GetResult</span>()
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">double</span> result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Operation() <span style="color:#f92672">=</span> <span style="color:#66d9ef">default</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OperationAdd</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Operation
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> GetResult() <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> numberA <span style="color:#f92672">+</span> numberB;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OperationSub</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Operation
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> GetResult() <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> numberA <span style="color:#f92672">-</span> numberB;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OperationFactory</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>Operation<span style="color:#f92672">&gt;</span> createOperation(<span style="color:#66d9ef">char</span> op)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">switch</span> (op)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>OperationAdd<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span><span style="color:#e6db74">&#39;-&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>OperationSub<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">throw</span> std<span style="color:#f92672">::</span>invalid_argument(<span style="color:#e6db74">&#34;Invalid operation type&#34;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">try</span> 
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">char</span> op;
</span></span><span style="display:flex;"><span>		std<span style="color:#f92672">::</span>cin <span style="color:#f92672">&gt;&gt;</span> op;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">auto</span> operation <span style="color:#f92672">=</span> OperationFactory<span style="color:#f92672">::</span>createOperation(op);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">double</span> a, b;
</span></span><span style="display:flex;"><span>		std<span style="color:#f92672">::</span>cin <span style="color:#f92672">&gt;&gt;</span> a <span style="color:#f92672">&gt;&gt;</span> b;
</span></span><span style="display:flex;"><span>		operation<span style="color:#f92672">-&gt;</span>setNumberA(a);
</span></span><span style="display:flex;"><span>		operation<span style="color:#f92672">-&gt;</span>setNumberB(b);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">double</span> result <span style="color:#f92672">=</span> operation<span style="color:#f92672">-&gt;</span>GetResult();
</span></span><span style="display:flex;"><span>		std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> result <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">catch</span>(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>exception<span style="color:#f92672">&amp;</span> ex)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		std<span style="color:#f92672">::</span>cerr <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Error &#34;</span> <span style="color:#f92672">&lt;&lt;</span> ex.what() <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="策略模式strategy">策略模式（Strategy）</h2>
<p>举例超市促销活动，有打八折、满300 - 100的活动等，如果给每一种活动都增加一个实现方法，重复度太高不方便维护。所以要将每个算法封装起来，并且可以互相替换，不同的策略表现出不同的行为，这就是策略模式。</p>
<p><strong>组成</strong>：</p>
<ul>
<li>
<p>环境角色（Context）：屏蔽客户端对策略算法的直接访问，封装可能存在的变化。</p>
</li>
<li>
<p>抽象策略角色（Strategy）：抽象类，给出所有具体策略类所需的接口。</p>
</li>
<li>
<p>具体策略角色（ConcreteStrategy）：具体的策略、算法实现。</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CashStrategy</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">double</span> calculate(<span style="color:#66d9ef">double</span> amount) <span style="color:#66d9ef">const</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>CashStrategy() <span style="color:#f92672">=</span> <span style="color:#66d9ef">default</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 正常收费
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CashNormal</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> CashStrategy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> calculate(<span style="color:#66d9ef">double</span> amount) <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> amount;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 满300 -100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CashReturn</span> <span style="color:#f92672">:</span><span style="color:#66d9ef">public</span> CashStrategy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> condition;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> cashback;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	CashReturn(<span style="color:#66d9ef">double</span> condition, <span style="color:#66d9ef">double</span> cashback) <span style="color:#f92672">:</span> condition(condition), cashback(cashback){}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> <span style="color:#a6e22e">calculate</span>(<span style="color:#66d9ef">double</span> amount)<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (amount <span style="color:#f92672">&gt;=</span> condition)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> amount <span style="color:#f92672">-</span> (<span style="color:#66d9ef">int</span>(amount <span style="color:#f92672">/</span> condition)) <span style="color:#f92672">*</span> cashback;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> amount;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CashRebate</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> CashStrategy
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> rebate;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	CashRebate(<span style="color:#66d9ef">double</span> rebate)<span style="color:#f92672">:</span>rebate(rebate){}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> <span style="color:#a6e22e">calculate</span>(<span style="color:#66d9ef">double</span> amount)<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">override</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> amount <span style="color:#f92672">*</span> rebate;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CashContext</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>CashStrategy<span style="color:#f92672">&gt;</span> strategy;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">explicit</span> CashContext(std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>CashStrategy<span style="color:#f92672">&gt;</span> strategy) <span style="color:#f92672">:</span> strategy(std<span style="color:#f92672">::</span>move(strategy)){}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> <span style="color:#a6e22e">getResult</span>(<span style="color:#66d9ef">double</span> amount) <span style="color:#66d9ef">const</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> strategy<span style="color:#f92672">-&gt;</span>calculate(amount);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">double</span> amount;
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cin <span style="color:#f92672">&gt;&gt;</span> amount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	CashContext contextNormal(std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>CashNormal<span style="color:#f92672">&gt;</span>());
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;正常收费&#34;</span> <span style="color:#f92672">&lt;&lt;</span> contextNormal.getResult(amount) <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	CashContext contextReturn(std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>CashReturn<span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">100</span>));
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;满300减100: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> contextReturn.getResult(amount) <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	CashContext contextRebate(std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>CashRebate<span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">0.8</span>));
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;打八折: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> contextRebate.getResult(amount) <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="单一职责原则">单一职责原则</h2>
<p>就一个类而言，应该仅有一个引起它变化的原因。</p>
<p>如果一个类承担的职责过多，就等于把这些职责耦合在一起，一个职责的变化可能会削弱或者抑制这个类完成其他职责的能力。这种耦合会导致脆弱的设计，当变化发生时，设计会遭受到意想不到的破坏。</p>
<h2 id="开放-封闭原则">开放-封闭原则</h2>
<p>对于扩展是开放的，对于更改是封闭的。</p>
<p>但无论模块是多么的封闭，都会存在一些无法对之封闭的变化。设计人员必须对他设计的模块应该对哪种变化封闭做出选择。他必须先猜测出最有可能发生的变化种类，然后构造抽象来隔离那些变化。</p>
<p><strong>面对需求，对程序的改动是通过增加新代码进行的，而不是更改现有的代码</strong>。</p>
<h2 id="依赖倒转原则">依赖倒转原则</h2>
<p>高层模块不应该依赖低层模块，两个都应该依赖抽象。</p>
<p>抽象不应该依赖细节，细节应该依赖于抽象。</p>
<p>总结：谁也不要依赖谁，除了约定的接口，大家都可以灵活自如。</p>
<h2 id="里氏替换原则">里氏替换原则</h2>
<p><strong>子类可以替换父类，并且程序的行为不会发生变化</strong>。</p>
<ul>
<li>子类必须完全实现父类的所有行为：子类不能违背父类提供的行为契约。</li>
<li>子类可以扩展父类的功能，但不能改变父类原有功能的本意。</li>
<li>子类替代父类时，不需要额外检查类型或进行特殊处理。</li>
</ul>
<p>例子：正方形在数学中属于长方形，于是在代码中将正方形继承于长方形，但是宽高在设置的时候会出现冲突，导致最后计算面积出错。所以它不遵循里氏替换原则，需要将正方形、长方形类分离，实现共同的Shape接口。</p>
<hr>
<h2 id="装饰模式decorator-pattern">装饰模式（Decorator Pattern）</h2>
<p><strong>组成</strong>：</p>
<ul>
<li>抽象接口：定义核心功能的接口（或基类）。</li>
<li>具体组件（Concrete Component）：实现抽象接口的基本功能类。</li>
<li>装饰器基类（Decorator Base Class）：继承抽象接口，包含对另一个抽象接口对象的引用。</li>
<li>具体装饰器（Concrete Decorator）：扩展装饰器基类，通过额外的功能装饰具体组件。</li>
</ul>
<hr>
<h2 id="享元模式flyweight">享元模式（FlyWeight）</h2>
<p>主要目的是通过共享对象来减少系统种对象的数量，<strong>其本质就是缓存共享对象，降低内存消耗</strong>。</p>
<p>享元模式将需要重复使用的对象分为两个部分：<strong>内部状态</strong>和<strong>外部状态</strong>。比如用户的账号是外部状态不能被共享，内部状态是可以共享的。</p>
<p><strong>组成</strong>：</p>
<ul>
<li>抽象享元角色（FlyWeight）：基类，定义出对象的外部状态和内部状态。</li>
<li>具体享元角色（ConcreteFlyWeight）：实现抽象享元类中的方法，是需要共享的对象类。</li>
<li>享元工厂（FlyWrightFactory）：使用一个map存储已经创建的享元对象。</li>
</ul>
<p>例子：如围棋游戏，只需要存储两个棋子对象，而不是每盘棋创建几百个棋子对象，比如.Net中的String，相同的字符串只有一个实例。</p>
<hr>
<h2 id="单例模式singleton">单例模式（Singleton）</h2>
<p>保证一个类只能产生一个实例，声明周期为整个程序的声明周期，通过Get访问到任何非静态方法。</p>
<p>懒汉式：需要时才会创建 线程不安全</p>
<p>饿汉式：一运行就创建实例，需要时直接调用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Singleton</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// 不允许实例化 调用构造函数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	Singleton(){}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> Singleton s_Instance;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 删除类的拷贝构造函数 防止对象被复制
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	Singleton(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span>) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 删除赋值运算符
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Singleton<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">=</span>(<span style="color:#66d9ef">const</span> Singleton<span style="color:#f92672">&amp;</span>) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// 返回单例实例
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">static</span> Singleton<span style="color:#f92672">&amp;</span> Get()
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> s_Instance;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Func</span>() {};
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>Singleton Singleton<span style="color:#f92672">::</span>s_Instance;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// 不可以去掉引用 否则会拷贝 所以需要增加一个删除函数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	Singleton<span style="color:#f92672">&amp;</span> instance <span style="color:#f92672">=</span> Singleton<span style="color:#f92672">::</span>Get();
</span></span><span style="display:flex;"><span>	instance.Func();
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cin.get();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>具体例子</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Random</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Random(){}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> Random s_Instance;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> m_RandomGenerator <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5f</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> <span style="color:#a6e22e">IFloat</span>() { <span style="color:#66d9ef">return</span> m_RandomGenerator; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	Random(<span style="color:#66d9ef">const</span> Random<span style="color:#f92672">&amp;</span>) <span style="color:#f92672">=</span> <span style="color:#66d9ef">delete</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> Random<span style="color:#f92672">&amp;</span> Get()
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">static</span> Random instance;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> instance;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">float</span> <span style="color:#a6e22e">Float</span>() { <span style="color:#66d9ef">return</span> Get().IFloat(); }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> number <span style="color:#f92672">=</span> Random<span style="color:#f92672">::</span>Float();
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> number <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>cin.get();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
        </div>
    </div>
</div><div id="social-media-share" class="has-text-centered">
	<p><i>Sharing is caring!</i></p>
	<br>
	
	<div class="share-buttons">
	    <a  href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Facebook. Opens in a new window.">
	        <img src=/img/icons/45px/facebook.png>
	    </a>

	    <a  href="https://twitter.com/intent/tweet?text=%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f&url=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        onclick="socialMediaPopUp(this.href, '', 500, 500); return false;"
	        title="Share on Twitter. Opens in a new window." >
	        <img src=/img/icons/45px/twitter.png>
	    </a>

		<a  href="http://www.reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Reddit. Opens in a new window." >
	        <img src=/img/icons/45px/reddit.png>
	    </a>

	    <a  href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Pinterest. Opens in a new window." >
	        <img src=/img/icons/45px/pinterest.png>
	    </a>

	    <a  href="http://www.tumblr.com/share/link?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on Tumblr. Opens in a new window." >
	        <img src=/img/icons/45px/tumblr.png>
	    </a>

		<a  href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f
			&title=%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f&summary=%e7%ae%80%e5%8d%95%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f%20Factory%ef%bc%9a%e5%b7%a5%e5%8e%82%e7%b1%bb%e6%98%af%e6%95%b4%e4%b8%aa%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%85%b3%e9%94%ae.%e5%8c%85%e5%90%ab%e4%ba%86%e5%bf%85%e8%a6%81%e7%9a%84%e9%80%bb%e8%be%91%e5%88%a4%e6%96%ad%2c%e6%a0%b9%e6%8d%ae%e5%a4%96%e7%95%8c%e7%bb%99%e5%ae%9a%e7%9a%84%e4%bf%a1%e6%81%af%2c%e5%86%b3%e5%ae%9a%e7%a9%b6%e7%ab%9f%e5%ba%94%e8%af%a5%e5%88%9b%e5%bb%ba%e5%93%aa%e4%b8%aa%e5%85%b7%e4%bd%93%e7%b1%bb%e7%9a%84%e5%af%b9%e8%b1%a1%e3%80%82%0a%e5%ae%a2%e6%88%b7%e7%ab%af%e4%bb%a3%e7%a0%81%e6%97%a0%e9%9c%80%e5%85%b3%e5%bf%83%e7%b1%bb%e7%9a%84%e5%ae%9e%e7%8e%b0%e7%bb%86%e8%8a%82%ef%bc%8c%e5%a6%82%e6%9e%9c%e9%9c%80%e8%a6%81%e6%96%b0%e5%a2%9e%e8%bf%90%e7%ae%97%ef%bc%8c%e5%8f%aa%e9%9c%80%e8%a6%81%e6%96%b0%e5%a2%9e%e5%af%b9%e5%ba%94%e7%9a%84%e6%b4%be%e7%94%9f%e7%b1%bb%ef%bc%8c%e5%b9%b6%e5%9c%a8%e5%b7%a5%e5%8e%82%e4%b8%ad%e6%b7%bb%e5%8a%a0%e9%80%bb%e8%be%91%e3%80%82%0aclass%20Operation%20%7b%20protected%3a%20double%20numberA%3b%20double%20numberB%3b%20public%3a%20void%20setNumberA%28double%20a%29%20%7b%20numberA%20%3d%20a%3b%20%7d%20void%20setNumberB%28double%20b%29%20%7b%20numberB%20%3d%20b%3b%20%7d%20virtual%20double%20GetResult%28%29%20%7b%20double%20result%20%3d%200%3b%20return%20result%3b%20%7d%20virtual%20~Operation%28%29%20%3d%20default%3b%20%7d%3b%20class%20OperationAdd%20%3a%20public%20Operation%20%7b%20public%3a%20double%20GetResult%28%29%20override%20%7b%20return%20numberA%20%2b%20numberB%3b%20%7d%20%7d%3b%20class%20OperationSub%20%3a%20public%20Operation%20%7b%20public%3a%20double%20GetResult%28%29%20override%20%7b%20return%20numberA%20-%20numberB%3b%20%7d%20%7d%3b%20class%20OperationFactory%20%7b%20public%3a%20static%20std%3a%3aunique_ptr%26lt%3bOperation%26gt%3b%20createOperation%28char%20op%29%20%7b%20switch%20%28op%29%20%7b%20case%20%26%2339%3b%2b%26%2339%3b%3a%20return%20std%3a%3amake_unique%26lt%3bOperationAdd%26gt%3b%28%29%3b%20case%26%2339%3b-%26%2339%3b%3a%20return%20std%3a%3amake_unique%26lt%3bOperationSub%26gt%3b%28%29%3b%20default%3a%20throw%20std%3a%3ainvalid_argument%28%26%2334%3bInvalid%20operation%20type%26%2334%3b%29%3b%20break%3b%20%7d%20%7d%20%7d%3b%20int%20main%28%29%20%7b%20try%20%7b%20char%20op%3b%20std%3a%3acin%20%26gt%3b%26gt%3b%20op%3b%20auto%20operation%20%3d%20OperationFactory%3a%3acreateOperation%28op%29%3b%20double%20a%2c%20b%3b%20std%3a%3acin%20%26gt%3b%26gt%3b%20a%20%26gt%3b%26gt%3b%20b%3b%20operation-%26gt%3bsetNumberA%28a%29%3b%20operation-%26gt%3bsetNumberB%28b%29%3b%20double%20result%20%3d%20operation-%26gt%3bGetResult%28%29%3b%20std%3a%3acout%20%26lt%3b%26lt%3b%20result%20%26lt%3b%26lt%3b%20std%3a%3aendl%3b%20%7d%20catch%28const%20std%3a%3aexception%26amp%3b%20ex%29%20%7b%20std%3a%3acerr%20%26lt%3b%26lt%3b%20%26%2334%3bError%20%26%2334%3b%20%26lt%3b%26lt%3b%20ex.&source=rafed123.github.io"
	        onclick="socialMediaPopUp(this.href, '', 900, 500); return false;"
	        title="Share on LinkedIn. Opens in a new window." >
	        <img src=/img/icons/45px/linkedin.png>
	    </a>

	    <a  href="mailto:?subject=%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f&amp;body=Check out this site http%3a%2f%2flocalhost%3a1313%2fposts%2fc%2b%2b%2fdesignpattern%2f"
	        title="Share via Email. Opens in a new window." >
	        <img src=/img/icons/45px/mail.png>
	    </a>
	</div>
</div>


<br>
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'disqus-code';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </div>
    </div>
<script async src="https://cse.google.com/cse.js?cx=google-search-code"></script>
<gcse:searchresults-only></gcse:searchresults-only>


<footer class="footer has-background-dark">
    <div class="content has-text-centered has-text-white">
        <p>
            © 2024 GeeTeng.My
            <a class="has-text-light" href="https://github.com/GeeTeng" target="_blank">
            GitHub</a>. 

	    Email: 15143483@qq.com
        </p>
    </div>
</footer>

<div id="particles-js"></div>
    <script src="/js/particles.min.js"></script>
    <script>
        particlesJS.load('particles-js', '/js/particlesjs-config.json', function() {
            console.log('callback - particles.js config loaded');
        });
    </script>
</body>

</html>
